# Задача CompoundEditor

Потрібно створити редактор, який дозволяє користувачам вводити текст з певними правилами синтаксису для посилання на таблиці, поля та функції бази даних. Редактор повинен підтримувати різні типи сутностей, такі як таблиці, поля та функції, і дозволяти користувачам легко створювати складні запити до бази даних.

Редактор має бути створений на базі HTMLInput і написаний на TypeScript. Він повинен підтримувати авто доповнення для таблиць, полів та функцій, а також дозволяти користувачам легко вставляти ці сутності в текст.

Редактор має бути реалізований як клас CompoundEditor, який містить методи для обробки введеного тексту, визначення типу сутності та генерації відповідного SQL запиту на основі введеного тексту для використання в `where`.

Результат роботи можна отримати через метод `getResult()`, який повертає згенеровану строку для використання в SQL запиті. 

## Типи сутностей

- `!` - Таблиця БД
- `#` - Поле БД
- `@` - Зарезервовано
- `$` - Функція

Якщо ввод починається з `!`, то це посилання на таблицю БД. Якщо ввод починається з `#`, то це посилання на поле БД. Якщо ввод починається з `$`, то це посилання на функцію. Якщо ввод починається з `@`, то це зарезервоване слово, яке не може бути використано як ім'я таблиці, поля або функції.

## Function Interface

```js
interface Func {
    name: string,
    arguments: any[] | undefined,
}
```

### Перелік доступних функцій

Math block:
- `min(#f)` - Пошук мінімального значення по полю таблиці
- `max(#f)` - Пошук максимального значення по полю таблиці
- `avg(#f)` - Пошук середнього значення по полю таблиці
- `sum(#f)` - Пошук суми значень по полю таблиці
- `count(#f)` - Пошук кількості записів по полю таблиці
- `round(#f, decimals)` - Округлення числа по полю таблиці до вказаної кількості десяткових знаків
- `ceil(#f)` - Округлення числа по полю таблиці вгору
- `floor(#f)` - Округлення числа по полю таблиці вниз

String block:
- `concat(#f1, #f2, ...)` - Конкатенація рядків по полях таблиці
- `length(#f)` - Пошук довжини рядка по полю таблиці
- `upper(#f)` - Перетворення рядка в верхній регістр по полю таблиці
- `lower(#f)` - Перетворення рядка в нижній регістр по полю таблиці
- `substring(#f, start_index, length)` - Повертає підрядок з рядка, починаючи з `start_index` і довжиною `length`
- `left(#f, length)` - Повертає ліву частину рядка довжиною `length`
- `right(#f, length)` - Повертає праву частину рядка довжиною `length`

Date block:
- `now()` - Поточна дата і час
- `today()` - Поточна дата
- `date(#f)` - Дата із значення поля дата з БД (вихідне значення timestamp)
- `month()` - Поточний місяць
- `month(#f)` - Місяць із значення поля дата з БД
- `year()` - Поточний рік
- `year(#f)` - Рік із значення поля дата з БД

*#f* - це посилання на поле таблиці БД, яке може бути використано як аргумент для функції.

Функції мають різні типи аргументів, які можуть бути рядками, числами або іншими полями таблиці БД. Вони можуть бути використані для виконання різних операцій над даними в таблиці БД, таких як агрегація, форматування або обчислення значень.

Функції мають описуватись через інтерфейс `Func`, який містить ім'я функції та її аргументи. Це дозволяє легко визначити, які функції доступні і як їх використовувати в контексті роботи з даними в таблиці БД.

Всі доступні функції мають бути описані в JSON форматі, легко розширятись і який може бути використаний для генерації документації або для інтеграції з іншими системами, які працюють з даними в таблиці БД.

## База даних

Опис бази даних має бути представлений у вигляді JSON об'єкта, який містить інформацію про таблиці, поля та їх типи. Наприклад:

```json
{
  "tables": [
    {
      "name": "users",
      "fields": [
        {"name": "id", "type": "integer"},
        {"name": "name", "type": "string"},
        {"name": "email", "type": "string"},
        {"name": "created_at", "type": "date"}
      ]
    },
    {
      "name": "orders",
      "fields": [
        {"name": "id", "type": "integer"},
        {"name": "user_id", "type": "integer"},
        {"name": "total", "type": "decimal"},
        {"name": "created_at", "type": "date"}
      ]
    }
  ]
}
```

## Оператори

Оператори можуть бути використані для виконання логічних або арифметичних операцій над даними в таблиці БД. Наприклад:

Логічні оператори:
- `AND` - Логічне І
- `OR` - Логічне АБО
- `NOT` - Логічне НЕ
- `=` - Рівність
- `!=` - Нерівність
- `>` - Більше
- `<` - Менше
- `>=` - Більше або рівно
- `<=` - Менше або рівно
- `LIKE` - Пошук по шаблону
- `IN` - Пошук в списку значень
- `BETWEEN` - Пошук в діапазоні значень
- `IS NULL` - Перевірка на NULL
- `IS NOT NULL` - Перевірка на не NULL

Арифметичні оператори:
- `+` - Додавання
- `-` - Віднімання
- `*` - Множення
- `/` - Ділення
- `%` - Остача від ділення

Ці оператори можуть бути використані в комбінації з функціями та полями таблиці БД для створення складних запитів і обчислень над даними. Вони дозволяють виконувати різні операції, такі як фільтрація, сортування, агрегація та інші маніпуляції з даними в таблиці БД.